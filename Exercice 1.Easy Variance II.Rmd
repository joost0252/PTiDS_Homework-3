---
title: "homework-3 - Exercice 1.Easy variance II"
author: "Amina Mohammed (17301920)"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r, echo = FALSE, include = FALSE, message = FALSE}
source(here::here("Setup.R"))
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### Problem statement

The bootstrap is a straightforward method for estimating quantities for a statistic such as an estimator of its variance. 


```{r echo = FALSE, include = FALSE, message = FALSE}
readRDS("test1.rds")

setwd(here::here(("Ressources/")))

test1 <- readr::readRDS("test1.rds")

setwd("Ressources")
list.files()
t1 = readRDS("test1.rds") head(t1)

 test1 <- file.choose()
 test1_test <- readRDS(test1)

readRDS("test1.rds")
```

#### Exercise Solving


1. Using your most efficient implementation of the bootstrap from the previous homework, write a function named `bootstrap` with arguments `x` for a vector of sample data, `B` for the number of bootstrapped samples with default values `1000L` and `statistic` for a generic function to be passed. The function must return a list with the statistic evaluated on the sample `x`, say `theta_hat`, on the bootstrapped samples, say `theta_star`, and an estimate of the variance of the statistic, say `varBoot`.

```{r echo = FALSE, include = FALSE, message = FALSE}
supermarket <- read.csv("supermarket_sales.csv")
unitPrice <- as.matrix(supermarket[,7])

# statistic on the sample 
têta_hat_mean <- mean(unitPrice)       # mean of unit price (theoretical)
têta_hat_median <- median(unitPrice)   # median of unit price (theoretical)
têta_hat_max <- max(unitPrice)         # max of unit price (theoretical)

B <- 1000                     #number of iteration

```


2.  Simulate a sample of size $10^4$ from a $t$-distribution with $\nu=3$ degrees of freedom (when $\nu\to\infty$, then the $t$-distribution tends to a standard normal distribution). Using the base R variance `var` as the `statistic`, compute the $B=1,000$ bootstrapped statistics using your function for subsamples of size $100$, $1,000$ and the full sample that you generated, and make three boxplots in one graph. The true variance is given by $\nu/(\nu-2)$. Illustrate it in your graph and comment what has been obtained. Does it illustrate some concepts in statistics or probability theory?

```{r echo = FALSE, include = FALSE, message = FALSE}

```

3.  Take the one of the subsample of 2., and compare the performances between your implementation of `bootstrap` with the function bootstrap from the bootstrap package (installation required). Make sure the comparison is as fair as possible (same number of bootstrap samples, ...).

```{r echo = FALSE, include = FALSE, message = FALSE}

```

4.  Load `test1.rds` and make this call `bootstrap(a, statistic = mean)`. The call must returns the following error:
```{r}
Error in bootstrap(a, statistic = mean) : 'x' must be numeric
```
Adapt your implementation until this error message shows.

```{r }

```
